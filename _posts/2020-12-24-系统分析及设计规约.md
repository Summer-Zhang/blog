---
layout:     post
title:      系统分析及设计规约
subtitle:   设计规约 
date:       2020-12-24
author:     Summer
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - UML 
    - 架构 
    - 规约 
    
---
# 系统分析及设计规约
本文以货车帮项目为入手点，带你进入系统分析及设计规约的相关认识。
***

**系统分析入手点：「业务逻辑」**

![MacDown logo](img/设计规约/货车帮货运业务.png)

### 1. 【强制】存储方案和底层数据结构的设计获得评审一致通过，并沉淀成为文档。  

![MacDown logo](/Users/summer/Documents/learning/设计规约/expresspolicy-ER.png)

> 说明：  
> 有缺陷的底层数据结构容易导致系统风险上升，可扩展性下降，重构成本也会因历史数 据迁 移和系统平滑过渡而陡然增加，所以，存储方案和数据结构需要认真地进行设计和评审， 生产环境提交执行后，需要进行 double check。

```
评审内容：	
* 存储介质选型、表结构设计能否满足技术方案、 
* 存取性能和存储空间能否满足业务发展、 
* 表或字段之间的辩证关系、字段名称、字段类型、索引等; 
*  数据结构变更(如 在原有表中新增字段)也需要进行评审通过后上线。  
```

### 2. 【强制】在需求分析阶段，如果与系统交互的 User 超过一类并且相关的 User Case 超过 5 个， 使用用例图来表达更加清晰的结构化需求。
![MacDown logo](/Users/summer/Documents/learning/设计规约/货车帮货运业务系统分析.png)

### 3. 【强制】如果某个业务对象的状态超过 3 个，使用状态图来表达并且明确状态变化的各个触发 条件。

![MacDown logo](/Users/summer/Documents/learning/设计规约/货车帮状态图.png)

> 状态图的核心是对象状态，首先明确对象有多少种状态，然后明确两两状态之间是否存 在直接转换关系，再明确触发状态转换的条件是什么。
	
### 4. 【强制】如果系统中某个功能的调用链路上的涉及对象超过 3 个，使用时序图来表达并且明确 各调用环节的输入与输出。
![MacDown logo](/Users/summer/Documents/learning/设计规约/货车帮时序图.png)

> 时序图反映了一系列对象间的交互与协作关系，清晰立体地反映系统的调用纵深链路

### 5. 【强制】如果系统中模型类超过 5 个，并且存在复杂的依赖关系，使用类图来表达并且明确类 之间的关系。
	
* 关联关系  
![MacDown logo](/Users/summer/Documents/learning/设计规约/单向关联.jpg)
在UML类图中单向关联用一个带箭头的直线表示。上图表示每个顾客都有一个地址，这通过让Customer类持有一个类型为Address的成员变量类实现。
* 聚合关系
![MacDown logo](/Users/summer/Documents/learning/设计规约/聚合.jpg)
上图中的Car类与Engine类就是聚合关系（Car类中包含一个Engine类型的成员变量）。由上图我们可以看到，UML中聚合关系用带空心菱形和箭头的直线表示。聚合关系强调是“整体”包含“部分”，但是“部分”可以脱离“整体”而单独存在。比如上图中汽车包含了发动机，而发动机脱离了汽车也能单独存在。
* 组合关系
![MacDown logo](/Users/summer/Documents/learning/设计规约/组合.jpg)
嘴是头的一部分且不能脱离了头而单独存在。在UML类图中，组合关系用一个带实心菱形和箭头的直线表示。
* 依赖关系
![MacDown logo](/Users/summer/Documents/learning/设计规约/依赖.jpg)
从上图我们可以看到，Driver的drive方法只有传入了一个Car对象才能发挥作用，因此我们说Driver类依赖于Car类。在UML类图中，依赖关系用一条带有箭头的虚线表示。
* 继承关系
![MacDown logo](/Users/summer/Documents/learning/设计规约/继承.jpg)
对应的是extend关键字，在UML类图中用带空心三角形的直线表示，如下图所示中，Student类与Teacher类继承了Person类。 
* 接口实现关系
![MacDown logo](/Users/summer/Documents/learning/设计规约/实现.jpg)
这种关系对应implement关键字，在UML类图中用带空心三角形的虚线表示。如下图中，Car类与Ship类都实现了Vehicle接口。

### 6. 【强制】如果系统中超过 2 个对象之间存在协作关系，并且需要表示复杂的处理流程，使用活 动图来表示。
> 活动图是流程图的扩展，增加了能够体现协作关系的对象泳道，支持表示并发等。

### 7. 【推荐】需求分析与系统设计在考虑主干功能的同时，需要充分评估异常流程与业务边界。  

### 8. 【推荐】类在设计与实现时要符合单一原则。
> 修改一个类不能影响到别的功能，也就是说只有一个导致该类被修改的原因。一个类如果承担过多的职责，就会有很多原因来导致这个类的被修改，就有很大可能性影响到别的功能。
	
```
单一原则优势：
1、低耦合性，影响范围小。
2、类复杂度降低，职责分明，提高了可读性。
3、职责单一，利于维护。
```
### 9. 【推荐】谨慎使用继承的方式来进行扩展，优先使用聚合/组合的方式来实现。
> 不得已使用继承的话，必须符合里氏代换原则，此原则说父类能够出现的地方子类一定 能够出现，比如，“把钱交出来”，钱的子类美元、欧元、人民币等都可以出现。

### 10. 【推荐】系统设计时，根据依赖倒置原则，尽量依赖抽象类与接口，有利于扩展与维护。
> 定义：  
> 1、高层模块不应该依赖低层模块，两都应该依赖于抽象。  
> 2、抽象不依赖于具体细节。  
> 3、具体细节应该依赖于抽象。  

### 11. 【推荐】系统设计时，注意对扩展开放，对修改闭合。

> 定义：一个软件的实体，包括类、方法、模块、应该对扩展开放，对修改关闭。也就是说一个软件的实体应该通过扩展的方式来修改变化，而不是修改已有实体源代码。
	
```
以下几种做法保证开放封闭原则：  
1、抽象出一个接口或者抽象类，定义公共的方法，达到扩展的目的。  
2、参数类型和引用类型使用接口或者抽象类，不能依赖实现类。  
3、接口和抽象类不能修改，可以使用继承接口或者抽象父类的形式达到扩展的目的。  
```
### 12. 【推荐】系统设计阶段，共性业务或公共行为抽取出来公共模块、公共配置、公共类、公共方法等，避免出现重复代码或重复配置的情况。  

### 13. 【推荐】避免如下误解：敏捷开发 = 讲故事 + 编码 + 发布。
> 说明:  
> 敏捷开发是快速交付迭代可用的系统，省略多余的设计方案，摒弃传统的审批流程，但核心关键点上的必要设计和文档沉淀是需要的。

### 14. 【参考】系统设计主要目的是明确需求、理顺逻辑、后期维护，次要目的用于指导编码。
> 说明：  
> 避免为了设计而设计，系统设计文档有助于后期的系统维护，所以设计结果需要进行分类归档保存。  

### 15. 【参考】设计的本质就是识别和表达系统难点，找到系统的变化点，并隔离变化点。  

### 16. 【参考】系统架构设计的目的：

```
确定系统边界。确定系统在技术层面上的做与不做。  
确定系统内模块之间的关系。确定模块之间的依赖关系及模块的宏观输入与输出。
确定指导后续设计与演化的原则。使后续的子系统或模块设计在规定的框架内继续演化。
确定非功能性需求。非功能性需求是指安全性、可用性、可扩展性等。
```